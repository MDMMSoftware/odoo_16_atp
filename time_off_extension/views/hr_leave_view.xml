<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="hr_leave_view_form_inherit" model="ir.ui.view">
        <field name="name">hr.leave.form.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form" />
        <field name="priority">999</field>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">
                <attribute name="delete">0</attribute>
                <attribute name="duplicate">0</attribute>
            </xpath>
            <xpath expr="//button[@name='action_approve']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_confirm']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_validate']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_refuse']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_cancel']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
    <record id="hr_leave_view_form_manager_inherit" model="ir.ui.view">
        <field name="name">hr.leave.form.manager.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form_manager" />
        <field name="priority">999</field>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">
                <attribute name="delete">0</attribute>
                <attribute name="duplicate">0</attribute>
            </xpath>
            <xpath expr="//button[@name='action_approve']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_confirm']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_validate']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_refuse']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_cancel']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='action_draft']" position="attributes">
                <attribute name="groups">hr_holidays.group_hr_holidays_manager</attribute>
            </xpath>
            <xpath expr="//button[@name='action_draft']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('refuse','validate','validate1'))]}</attribute>
            </xpath>
            <!-- <xpath expr="(//field[@name='employee_ids'])[2]" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath> -->
            
            <xpath expr="//field[@name='holiday_status_id']" position="after">
                <field name="holiday_status_code" invisible="1" />
                <field name="relation_of_deceased" attrs="{
                        'readonly':[('state','in',('refuse','validate','validate1'))], 
                        'invisible': [('holiday_status_code','!=','BL')],
                        'required': [('holiday_status_code','=','BL')]}"
                        
                            />
            </xpath>
            <xpath expr="(//field[@name='holiday_type'])[2]" position="attributes">
                <attribute name="readonly">1</attribute>
            </xpath>
            <xpath expr="//div[@name='duration_display']" position="after">
                <label for="number_of_days" string="Duration (Days)"/>
                <div name="duration_days_display">   
                    <div class="o_row">
                        <field name="number_of_days" class="oe_inline" attrs="{'readonly':[('state','in',('refuse','validate','validate1'))]}" />
                    </div>
                    <div attrs="{'invisible': [('leave_type_request_unit', '!=', 'hour')]}" class="o_row">
                        <field name="number_of_hours_text"/>
                    </div>
                </div>    
                <field name="prepare_id" invisible="1" />
                <field name="duty_cover_id" attrs="{
                                'invisible':[('prepare_id','=',False)], 
                                'readonly':[('state','in',('validate','validate1','refuse'))]
                                }" />
                <field name="duty_cover_ids" attrs="{'invisible':[('prepare_id','!=',False)],'readonly':[('state','in',('validate','validate1','refuse'))]}" widget="many2many_avatar_employee"/>
                <field name="department_ids" invisible="1" />
            </xpath>
            <xpath expr="(//field[@name='request_date_from'])[2]" position="attributes">
                <attribute name="widget"></attribute>
                <attribute name="attrs">{'readonly': [('state', 'not in', ('draft', 'confirm'))],'required': ['|', ('date_from', '=', False), ('date_to', '=', False)]}</attribute>

            </xpath>
            <xpath expr="(//field[@name='request_date_from'])[1]" position="attributes">
                <attribute name="widget"></attribute>
                <attribute name="attrs">{'readonly': [('state', 'not in', ('draft', 'confirm'))],'required': ['|', ('date_from', '=', False), ('date_to', '=', False)]}</attribute>

            </xpath>
            <xpath expr="(//field[@name='request_date_from_period'])[1]" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'not in', ('draft', 'confirm'))],'required': ['|', ('date_from', '=', False), ('date_to', '=', False)]}</attribute>

            </xpath>
            <xpath expr="(//field[@name='request_date_to'])[1]" position="attributes">
                <attribute name="widget"></attribute>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                <field name="hr_remark" />
                <field name="timeoff_attachment_ids" attrs="{'invisible':[('leave_type_support_document', '=', False)],'readonly':[('state','in',('validate','validate1','refuse'))]}">
                    <tree editable="bottom">
                        <field name="import_file" filename="import_fname" string="Attachments" />
                        <field name="import_fname" invisible="1" class="oe_inline oe_right" />
                    </tree>
                </field>
            </xpath>
            <xpath expr="//label[@for='number_of_days_display']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//div[@name='duration_display']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//label[@for='supported_attachment_ids']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='supported_attachment_ids']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
    
<!-- hr_leave_action_action_approve_department -->
    <record id="hr_holidays.hr_leave_action_action_approve_department" model="ir.actions.act_window">
        <field name="name">All Time Off</field>
        <field name="res_model">hr.leave</field>
        <field name="view_mode">tree,kanban,form,calendar,activity</field>
        <field name="search_view_id" ref="hr_holidays.hr_leave_view_search_manager"/>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Meet the time off dashboard.
            </p><p>
                A great way to keep track on employeeâ€™s PTOs, sick days, and approval status.
            </p>
        </field>
    </record>

    <record id="hr_holidays.action_hr_holidays_dashboard" model="ir.actions.act_window">
        <field name="name">All Time Off</field>
        <field name="res_model">hr.leave.report.calendar</field>
        <field name="view_mode">calendar</field>
        <field name="search_view_id" ref="hr_holidays.hr_leave_report_calendar_view_search"/>
        <field name="domain">[('employee_id.active','=',True)]</field>
        <field name="context">{}</field>
    </record>

    <menuitem
        id="hr_holidays.hr_holidays_menu_manager_approve_allocations"
        name="Allocations"
        parent="hr_holidays.menu_hr_holidays_approvals"
        action="hr_holidays.hr_leave_allocation_action_approve_department"
        sequence="2"
        groups="hr_holidays.group_hr_holidays_user" />

    <menuitem
        id="hr_holidays.menu_open_department_leave_approve"
        name="Time Off"
        parent="hr_holidays.menu_hr_holidays_approvals"
        action="hr_holidays.hr_leave_action_action_approve_department"
        sequence="1"
        groups="hr_holidays.group_hr_holidays_user" />

        <menuitem
        id="hr_holidays.menu_hr_holidays_approvals"
        name="Approvals"
        parent="hr_holidays.menu_hr_holidays_root"
        sequence="3"
        groups="hr_holidays.group_hr_holidays_user"/>


</odoo> 